# .envrc
# This file is used to set environment variables for the project.

# --- Activate mise for tool version management ---
# Load mise if available
if command -v mise &> /dev/null; then
  eval "$(mise activate bash)"
  # Trust and install tools defined in .mise.toml
  mise trust --quiet 2>/dev/null || true
  mise install --quiet 2>/dev/null || true
fi

# --- Load secrets from Infisical ---
# Safety first
set -euo pipefail

: "${FIRECRAWL_API_KEY:=$(infisical secrets get FIRECRAWL_API_KEY --path="/API-keys" --plain 2>/dev/null || true)}"

# Firecrawl API Key handling
if [ -z "$FIRECRAWL_API_KEY" ]; then
  if [ -n "$CI" ]; then
    echo "❌ FIRECRAWL_API_KEY not available – failing early." >&2
    exit 1
  else
    echo "⚠️  FIRECRAWL_API_KEY could not be retrieved – Firecrawl API operations may fail." >&2
  fi
else
  export FIRECRAWL_API_KEY
fi